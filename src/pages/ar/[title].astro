---
import AnimationsPanel from "../../components/AnimationsPanel.astro";
import Layout from "../../layouts/Layout.astro";
import type { IAnimation } from "../../types/customInterfaces";
import { animationsData } from "../../data/animationsData";
import { ENTITY_ATTRIBUTES, SCENE_ATTRIBUTES } from "../../constants/main";
import NewAnimationsPanel from "../../components/NewAnimationsPanel.astro";
const { title } = Astro.params;

export async function getStaticPaths() {
  return [
    {
      params: { title: "celula-animal" },
    },
    {
      params: { title: "celula-procariota" },
    },
    {
      params: { title: "celula-sanguinea" },
    },
    {
      params: { title: "celula-muscular" },
    },
    {
      params: { title: "neurona" },
    },
    {
      params: { title: "piel" },
    },
    {
      params: { title: "celula-osea" },
    },
    {
      params: { title: "tejido-vegetal" },
    },
    {
      params: { title: "prueba" },
    },
    {
      params: { title: "emission" },
    },
    {
      params: { title: "bsdf" },
    }, //? take a decision about what renderer to use
    {
      params: { title: "celula-eucariota" },
    },
  ];
}

const animations: IAnimation[] = animationsData[title];
---

<Layout title={animations[0].dataSections[0].label!}>
  <main class="h-full bg-primary">
    <section class="h-full relative px-4 pb-4 flex flex-col">
      <img
        src="/ar-bg-leaves.png"
        alt="Fondo de hojas"
        class="absolute z-10 top-0 left-0 w-full h-full pointer-events-none"
      />
      <nav class="relative z-50 flex items-center py-3 justify-start">
        <a
          href="#"
          id="goBackAnchor"
          class="flex gap-0 items-center text-light underline"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-10"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15.75 19.5 8.25 12l7.5-7.5"></path>
          </svg>
          Volver
        </a>
      </nav>
      <div
        class="overflow-hidden relative block w-full h-[calc(100%-16px)] bg-light"
      >
        <a-scene {...SCENE_ATTRIBUTES}>
          <a-assets>
            <a-asset-item id="celula-animal" src=`/assets/${title}/model.glb`
            ></a-asset-item>
          </a-assets>
          <a-camera
            scale="1 1 1"
            position="0 0 0"
            look-controls="enabled: false"
          >
          </a-camera>

          <a-marker
            id="celulaAnimalMarker"
            type="pattern"
            preset="custom"
            url="/assets/celula-animal/marker.patt"
            emitevents="true"
            smooth="true"
            scale="0 0 0"
            smoothCount="10"
            smoothTolerance="5"
            smoothThreshold="5"
            raycaster="objects: .clickable"
            cursor="fuse: false; rayOrigin: mouse;"
          >
            <a-entity
              id="animatedModel"
              position="0 0.5 -0.1"
              rotation="0 90 0"
              gltf-model="#celula-animal"
              {...ENTITY_ATTRIBUTES}
              ></a-entity>
          </a-marker>

          <!-- <a-nft
            id="celulaAnimalMarker"
            type="nft"
            url="/assets/nft/nft-marker"
            scale="0 0 0"
            smooth="true"
            emitevents="true"
            smoothCount="10"
            smoothTolerance=".01"
            smoothThreshold="5"
            raycaster="objects: .clickable"
            cursor="fuse: false; rayOrigin: mouse;"
          >
            <a-entity
              id="animatedModel"
              position="0 0.5 -0.1"
              rotation="0 90 0"
              scale="10 10 10"
              animation-mixer="clip: Celula.rest; timeScale: 1"
              gltf-model="#celula-animal"
              class="clickable"
              gesture-handler="minScale: 0.25; maxScale: 10; rotationFactor: 0"
            ></a-entity>
          </a-nft> -->

          <a-entity light="type: ambient; color: #fff; intensity: 4"></a-entity>

          <!-- <a-light type="directional" light="castShadow:true;" position="1 1 1" intensity="100" shadow-camera-automatic="#objects"></a-light> -->

          <!-- <a-entity light="color: #fff; intensity: 1" position="0 32 32"
          ></a-entity> -->

          <!-- <a-light type="directional" light="castShadow:true;" position="1 1 1" intensity="0.5" shadow-camera-automatic="#objects" target="#celulaAnimalMarker">


            <a-marker
            id="celulaAnimalMarker"
            type="pattern"
            preset="custom"
            url="/assets/celula-animal/marker.patt"
            emitevents="true"
            smooth="true"
            scale="0 0 0"
            smoothCount="10"
            smoothTolerance="5"
            smoothThreshold="5"
            raycaster="objects: .clickable"
            cursor="fuse: false; rayOrigin: mouse;"
            visible
          >
            <a-entity
            id="animatedModel"
            position="0 0.5 -0.1"
            rotation="0 90 0"
            scale="10 10 10"
            animation-mixer="clip: Celula.rest; timeScale: 1"
            gltf-model="#celula-animal"
            class="clickable"
            gesture-handler="minScale: 0.25; maxScale: 10; rotationFactor: 0"
          ></a-entity>
        </a-marker>

          </a-light> -->

          <!-- <a-entity light="type: point; color: #fff; intensity: 2" position="0 4 3"></a-entity> -->
        </a-scene>
      </div>
      <NewAnimationsPanel animations={animations} />
    </section>
  </main>
</Layout>

<script src="../../scripts/title.js"></script>
